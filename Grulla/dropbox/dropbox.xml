<?xml version="1.0" encoding="UTF-8"?>
<chapter>
  <title>Creando un buzón compartido</title>

  <section>
    <title>Sobre el contenido de este artículo</title>

    <para>El artículo ha sido escrito con el mayor cuidado posible para que
    los usuarios que tengan poca experiencia con el terminal, puedan seguirlo.
    No obstante, se asume un nivel básico de conocimiento sobre el sistema
    operativo linux y no entraremos en detalle en los comandos y términos
    utilizados.</para>
  </section>

  <section>
    <title>¿ Para qué un buzón compartido ? ¿ Qué es eso ?</title>

    <para>Seguro que alguna vez hemos querido pasar a alguien un archivo y nos
    hemos encontrado con que el envío de archivos en el nuestro cliente de
    mensajería esta roto, o no sabemos utilizar el dcc en nuestro cliente de
    irc (o no nos acordamos), o simplemente queremos transferir archivos con
    un amigo de forma rápida y sencilla, o queremos que nuestros amigos nos
    puedan dejar archivos en nuestro ordenador cuando estamos ausentes.</para>

    <para>Os habréis dado cuenta de que este es uno de los problemas
    habituales de compartir archivos. Para este fin, existen una buena
    cantidad de tecnologías a nuestra disposición. Unas son muy sencillas de
    utilizar pero poco seguras, otras mas seguras, pero requieren un cierto
    nivel de conocimiento sobre la tecnología, unas son mas lentas que otras,
    etc.</para>

    <para>La solución que yo propongo aquí, es extremadamente sencilla de
    utilizar, y creo que es lo suficientemente segura ( aunque no soy un
    experto en seguridad ).</para>
  </section>

  <section>
    <title>Requisitos previos</title>

    <para>Para lo que resta del mini-como, asumiré que disponemos del
    siguiente software instalado en nuestro ordenador.</para>

    <itemizedlist>
      <listitem>
        <para>Servidor de ssh.</para>
      </listitem>

      <listitem>
        <para>El programa scponly.</para>
      </listitem>

      <listitem>
        <para>El escritorio GNOME.</para>
      </listitem>
    </itemizedlist>

    <para>Si vuestra distribución es Debian, podéis usar synaptic o apt-get
    para instalar estos componentes en el caso de que no los tengáis todavía.
    En el caso de que uséis Redhat/Fedora o similares, es probable que scponly
    no esté incluido entre los paquetes oficiales de la distribución. Podéis
    obtenerlo <ulink url="http://sublimation.org/scponly/">aquí</ulink>.<note>
        <para>La explicación de que son, o el funcionamiento de las anteriores
        tecnologías, requiere algo más que un mini-como y por tanto se escapa
        del alcance de este artículo.</para>
      </note></para>
  </section>

  <section>
    <title>Configuración del sistema y creación del buzón</title>

    <para>Los pasos que voy a describir a continuación, pueden ser fácilmente
    automatizado. Podréis encontrar un script que automatiza todo el proceso
    en esta <ulink
    url="http://mspace.berlios.de/Grulla/dropbox/">dirección</ulink>.
    Explicaré mas adelante como utilizar el script.</para>

    <para>En principio, los pasos deben realizarse como usuario, salvo que
    indique lo contrario. Los pasos a seguir son los siguientes:</para>

    <orderedlist>
      <listitem>
        <para>Creación del directorio Dropbox en nuestro directorio de
        usuario.</para>

        <para><screen>mkdir ~/Dropbox</screen></para>
      </listitem>

      <listitem>
        <para>Añadir el grupo dropbox al sistema. <remark>Requiere ser usuario
        root</remark>.</para>

        <para><screen>addgroup dropbox</screen></para>
      </listitem>

      <listitem>
        <para>Crear una cuenta en nuestro sistema para la persona que queremos
        invitar a nuestro dropbox. Supongamos que yo me llamo
        <emphasis>Foo</emphasis> y nuestro amigo al que queremos invitar se
        llama <emphasis>Bar</emphasis>. <remark>Requiere ser usuario
        root</remark>.</para>

        <para><screen>useradd -d /home/<remark>Foo</remark>/Dropbox -g dropbox -s /usr/bin/scponly <remark>Bar</remark></screen></para>

        <para>Recordad que hay que reemplazar Foo y Bar por nuestro nombre y
        el del amigo. Esto creará una cuenta limitada para su uso solo con
        scp/sftp. Nuestro amigo no podrá hacer login en nuestra máquina. De
        esto se encarga scponly.</para>
      </listitem>

      <listitem>
        <para>Ahora tenemos que dar permisos a la carpeta para que nuestro
        invitado pueda escribir y leer en dicha carpeta.</para>

        <para><screen>chmod g+srw ~/Dropbox</screen></para>
      </listitem>

      <listitem>
        <para>Ya solo nos queda crear el fichero que será nuestra invitación,
        que podremos enviar a nuestro amigo para que se lo coloque en su
        escritorio. Abrid el editor que más os guste y teclead lo
        siguiente:</para>

        <para><programlisting>[Desktop Entry]
Version=1.0
Encoding=UTF-8
Name=<remark>Foo</remark> DropBox
Type=Link
URL=sftp://<remark>Foo-ip</remark>/home/<remark>Foo</remark>/Dropbox
Terminal=false
Icon=gnome-fs-share.png</programlisting></para>

        <para>Debemos cambiar Foo por nuestro nombre real y Foo-ip por nuestra
        ip o nombre de dominio. Guardad el fichero en texto plano y con
        extensión <emphasis>.desktop</emphasis>. Al dejarlo en el escritorio,
        este fichero aparecerá como un icono con nombre <emphasis>Foo
        Dropbox</emphasis> y sin extensión.</para>

        <para>Sin entrar en mucho detalle, lo que hace este fichero es decirle
        a nautilus que es lo que tiene que hacer cuando hacemos doble click
        sobre el. Le dice que se conecte a una carpeta remota (que sera
        nuestro Dropbox) utilizando sftp. Indica también el nombre que
        aparecerá en el icono (Name) el icono que mostrará (Icon) y si
        queremos que se lance desde un terminal.</para>
      </listitem>

      <listitem>
        <para>Con esto ya hemos terminado. Solo nos queda mandar este último
        archivo que hemos creado a nuestro amigo a modo de invitación. Lo
        único que tiene que hacer es guardarlo en su escritorio. Podrá
        arrastrar archivos sobre el y se copiarán directamente en nuestro
        buzón, o también podrá hacer doble click y nautilus abrirá una ventana
        para que pueda navegar por el contenido de nuestro buzón.</para>
      </listitem>
    </orderedlist>
  </section>

  <section>
    <title>Utilización del script para automatizar el proceso</title>

    <para>bla bla bla bla</para>

    <para></para>
  </section>

  <section>
    <title>Referencias</title>

    <para></para>
  </section>
</chapter>